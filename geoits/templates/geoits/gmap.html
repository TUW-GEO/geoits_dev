{% extends "base.html" %}
{% load staticfiles %}
{% block head_title %}GeoITS Development{% endblock %}

{% block map %}

<script language="Javascript" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=drawing,geometry"></script>
<script src="{% static 'js/gmap.js' %}"></script>

<body onload="initialize()" style="height: 50px;">
    <!--Google Maps APIv3 Background-->
    <form action="" method="POST"> {%csrf_token%}
        <div id="map_canvas"></div>
    </form>

    <form>
        {{ form.media }}
        {% for item in map_results %}
            {{item}}
        {% endfor %}
    <div id="result"></div>
    </form>
    <nav class="cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">
        <h3>Issue</h3>
        <textarea id="wiki" rows="18" cols="70"></textarea>
        <input class="btn btn-success" id="submit" type="button" value="Submit" name="csrfmiddlewaretoken"></input>
    </nav>
    <div class="navbar-form navbar-right" id="button">
        <button class="btn btn-success" id="showLeft">Save</button>
    </div>
    <script>
        var menuLeft = document.getElementById( 'cbp-spmenu-s1' ),
            showLeft = document.getElementById( 'showLeft' ),
            body = document.body;

        showLeft.onclick = function() {
            classie.toggle( this, 'active' );
            classie.toggle( menuLeft, 'cbp-spmenu-open' );
        };
    </script>
    <script>
        $("input").click(function() {
            $.ajax({
                url: "test/",
                type: 'POST',
                cache: false,
                dataType: 'json',
                data: {
                    geom : wkt,
                    csrfmiddlewaretoken: $("input[name='csrfmiddlewaretoken']").val()
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    alert("Messaging failed: " + errorThrown);
                },
                success: function(data) {
                    $('#result').append('ServerResponse:' + data.server_response)
                }
            });
        })
    </script>
</body>

{% endblock %}
